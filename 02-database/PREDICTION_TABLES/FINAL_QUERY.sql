SELECT 
 A.[StopName]
,[Date]
,[HourIntervals]
,[BusEntries]
,[Hours]
,[Time]
,[DayofWeek]
,[FlagEvent]
,[FlagMorning]
,[FlagAfternoon]
,[FlagEvening]
,[FlagNight]
,[FlagWeekend]
,[FlagRushHour]
,[FlagEventPeak]
,CASE WHEN [CountGIRA] IS NOT NULL THEN [CountGIRA] ELSE 0 END AS [CountGiraStops]
,CASE WHEN [MarathonFlag] IS NOT NULL THEN [MarathonFlag] ELSE 0 END AS [MarathonPathFlag]
,CASE WHEN [CountJams] IS NOT NULL THEN [CountJams] ELSE 0 END AS [CountJams]
,CASE WHEN [MeanSpeed] IS NOT NULL THEN [MeanSpeed] ELSE -1 END AS [MeanSpeed]
,CASE WHEN [CountTrainStops] IS NOT NULL THEN [CountTrainStops] ELSE 0 END AS [CountTrainStops]
,CASE WHEN [CountMetroStops] IS NOT NULL THEN [CountMetroStops] ELSE 0 END AS [CountMetroStops]
,CASE WHEN [Temperature] IS NOT NULL THEN [Temperature] ELSE -1 END AS [Temperature]
,CASE WHEN [Humidity] IS NOT NULL THEN [Humidity] ELSE -1 END AS [Humidity]
,CASE WHEN [Precipitation] IS NOT NULL THEN [Precipitation] ELSE -1 END AS [Precipitation]
,CASE WHEN [Sun] IS NOT NULL THEN [Sun] ELSE -1 END AS [Sun]
,CASE WHEN [WindSpeed] IS NOT NULL THEN [WindSpeed] ELSE -1 END AS [WindSpeed]
,CASE WHEN [WindCardinal] = 'North' THEN 1 WHEN [WindCardinal] = 'North-East' THEN 2 WHEN [WindCardinal] = 'North-East' THEN 3 WHEN [WindCardinal] = 'South-East' THEN 4 WHEN [WindCardinal] = 'South' THEN 5 WHEN [WindCardinal] = 'South-West' THEN 6 WHEN [WindCardinal] = 'West' THEN 7 WHEN [WindCardinal] = 'North-West' THEN 8 ELSE '-1' END AS [WindCardinal]
,[Contagem de Carreiras] AS [CarreirasCount]
,[Contagem de Paragens] AS [StopsCount]
FROM BASE_PREDICTION_FINAL_3 A
LEFT JOIN [pred].[GIRA_STOPS] B ON A.[StopName] = B.[StopName]
LEFT JOIN [pred].[MARATHON_ROUTE_STOPS] C ON A.[StopName] = C.[StopName]
LEFT JOIN [pred].[STOP_JAMS] D ON A.[StopName] = D.[StopName] AND A.[HourIntervals] = D.[DateTime]
LEFT JOIN [pred].[STOP_METRO] E ON A.[StopName] = E.[StopName]
LEFT JOIN [pred].[STOP_TRAIN] F ON A.[StopName] = F.[StopName]
INNER JOIN [pred].[WEATHER] G ON A.[StopName] = G.[StopName] AND A.[HourIntervals] = G.[DateTime]
INNER JOIN [pred].[CONTAGEM_CARREIRAS] H ON A.[StopName] = H.[Stop Name]
INNER JOIN [pred].[CONTAGEM_PARAGENS] I ON A.[StopName] = I.[Stop Name]
WHERE [Hours] BETWEEN 6 AND 22
ORDER BY 1,3



